<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>演示 React的生命周期 </title>
    <script type="text/javascript" src="../react.js"></script>
    <script type="text/javascript" src="../JSXTransformer.js"></script>
</head>
<body>
<div id="demo1"></div>
<script type="text/jsx">
    var count = 0;
    var style = {
        color: "red",
        border: "1px #000 solid",
    };
    var HelloWorld = React.createClass({
        getDefaultProps: function () {//该方法只会被调用一次，任何复杂的值，比如对象和数组，都会在所有的实例中共享
            console.log("getDefaultProps, 1");
            return {name: "Tom"};
        },
        getInitialState: function () {
            //每个实例只会被调用一次，获取初始化状态。
            //在这个方法里，已经可以访问this.props了
            console.log("getInitialState, 2");
            return {myCount: count++,ready: false};
        },
        componentWillMount: function () {
            console.log("componentWillMount, 3");
            /**
             * render之前被调用，这里是修改state的最后机会了
             */
            this.setState({ready: true});
        },
        render: function () {
            /**
             * 对于一个组件这个方法是必须的
             * 特点：
             * 只能通过this.props和this.state访问数据
             * 可以返回null,false 或者任何React组件
             * 只能出现一个顶级组件
             * 必须纯净，意味着不能改变组件的状态或者修改DOM的输出
             */
            console.log("render, 4");
            return <p>Hello, {this.props.name ? this.props.name : "World"}<br/>{"" + this.state.ready} {this.state.myCount}</p>;
        },
        componentDidMount: function () {
            /**
             * render 方法返回的不是真正的DOM,这个方法执行的时候，真正的DOM已经生成
             * 我们可以通过调用this.getDOMNode()访问到它
             *
             */
            console.log("componentDidMount, 5");
        }
    });
    React.render(<div style={style}><HelloWorld></HelloWorld><br/></div>,document.getElementById("demo1"));

    /**
     * 触发顺序如下：
     * getDefaultProps, 1
     * getInitialState, 2
     * componentWillMount, 3
     * render, 4
     * componentDidMount, 5
     */

</script>

</body>
</html>